object FMedocCheckDocs: TFMedocCheckDocs
  Left = 342
  Height = 356
  Top = 250
  Width = 637
  BorderStyle = bsNone
  Caption = 'Звітне стикування'
  ClientHeight = 356
  ClientWidth = 637
  LCLVersion = '4.4.0.0'
  OnCreate = FormCreate
  OnDestroy = FormDestroy
  object DBGrid1: TDBGrid
    Left = 0
    Height = 244
    Top = 112
    Width = 637
    Align = alClient
    Color = clWindow
    Columns = <>
    DataSource = DmFbConnect.DataSource1
    ReadOnly = True
    TabOrder = 0
    Visible = False
    OnDrawColumnCell = DBGrid1DrawColumnCell
  end
  object Panel1: TPanel
    Left = 0
    Height = 112
    Top = 0
    Width = 637
    Align = alTop
    ClientHeight = 112
    ClientWidth = 637
    Color = clWhite
    ParentBackground = False
    ParentColor = False
    TabOrder = 1
    object ComboBoxPath: TComboBox
      Left = 136
      Height = 23
      Top = 8
      Width = 448
      Color = clYellow
      ItemHeight = 15
      TabOrder = 0
      Text = 'ComboBoxPath'
      OnChange = ComboBoxPathChange
    end
    object Label1: TLabel
      Left = 15
      Height = 15
      Top = 8
      Width = 103
      Caption = 'Шлях до програми'
      Color = clMenuHighlight
      ParentColor = False
    end
    object Label2: TLabel
      Left = 15
      Height = 15
      Top = 32
      Width = 38
      Caption = 'Період'
    end
    object Label3: TLabel
      Left = 15
      Height = 15
      Top = 56
      Width = 82
      Caption = 'Тип документу'
    end
    object ButtonExec: TButton
      Left = 136
      Height = 25
      Top = 80
      Width = 91
      Caption = 'Сформувати'
      Font.CharSet = RUSSIAN_CHARSET
      Font.Pitch = fpVariable
      Font.Quality = fqDraft
      ParentFont = False
      TabOrder = 1
      OnClick = ButtonExecClick
    end
    object ButtonPrint: TButton
      Left = 240
      Height = 25
      Top = 80
      Width = 75
      Caption = 'Друк'
      Enabled = False
      TabOrder = 2
    end
    object ButtonOrderLicense: TButton
      Left = 432
      Height = 25
      Top = 80
      Width = 75
      Caption = 'Замовити'
      TabOrder = 3
      OnClick = ButtonOrderLicenseClick
    end
    object ButtonGetLicense: TButton
      Left = 509
      Height = 25
      Top = 80
      Width = 75
      Caption = 'Оновити'
      TabOrder = 4
      OnClick = ButtonGetLicenseClick
    end
  end
  object ComboBoxMonth: TComboBox
    Left = 136
    Height = 23
    Top = 32
    Width = 176
    Color = clYellow
    DropDownCount = 20
    ItemHeight = 15
    TabOrder = 2
    Text = 'ComboBoxMonth'
  end
  object ComboBoxYear: TComboBox
    Left = 328
    Height = 23
    Top = 32
    Width = 136
    Color = clYellow
    DropDownCount = 20
    ItemHeight = 15
    TabOrder = 3
    Text = 'ComboBoxYear'
  end
  object ComboBoxDoc: TComboBox
    Left = 136
    Height = 23
    Top = 56
    Width = 448
    Color = clYellow
    DropDownCount = 20
    ItemHeight = 15
    TabOrder = 4
    Text = 'ComboBoxDoc'
  end
  object SQLQuery1: TSQLQuery
    FieldDefs = <>
    AfterOpen = SQLQuery1AfterOpen
    SQL.Strings = (
      'SELECT'
      '    ORG.EDRPOU,'
      '    ORG.DEPT,'
      '    ORG.SHORTNAME,'
      '    ORG.INDTAXNUM,'
      '    C.PERDATE,'
      '    C.CARDSENDSTT_NAME,'
      '    C.CHARCODE,'
      '    C.MODDATE,'
      '    C.StatusName'
      'FROM'
      '    ORG'
      'LEFT JOIN ('
      '    SELECT'
      '        CARD.IDORG,'
      '        CARD.PERDATE,'
      '        CARDSENDSTT.NAME AS CARDSENDSTT_NAME,'
      '        FORM.CHARCODE,'
      '        CARD.MODDATE,'
      '        CARDSTATUS.NAME AS StatusName'
      '    FROM CARD'
      '    LEFT JOIN FORM'
      '        ON FORM.CODE = CARD.FORM'
      '    LEFT JOIN CARDSTATUS'
      '        ON CARDSTATUS.CODE = CARD.STATUS'
      '    LEFT JOIN CARDSENDSTT'
      '        ON CARDSENDSTT.CODE = CARD.SENDSTT'
      '    WHERE'
      '        CARD.PERDATE = DATE %_PERDATE'
      '        AND CARD.IDPARENT IS NULL'
      '        AND CARD.FORM > 0'
      '        AND LOWER(FORM.CHARCODE) = :_CHARCODE'
      ') C'
      '    ON C.IDORG = ORG.CODE'
      'WHERE'
      '    ORG.DEPT IS NULL OR ORG.DEPT <> ''0'''
      'ORDER BY'
      '    C.StatusName,'
      '    ORG.SHORTNAME'
      ''
    )
    Params = <    
      item
        DataType = ftUnknown
        Name = '_CHARCODE'
        ParamType = ptInput
      end>
    Macros = <    
      item
        DataType = ftUnknown
        Name = '_PERDATE'
        ParamType = ptInput
      end>
    MacroCheck = True
    Left = 296
    Top = 136
  end
  object SQLQueryCodes: TSQLQuery
    FieldDefs = <>
    AfterOpen = SQLQuery1AfterOpen
    SQL.Strings = (
      'SELECT'
      '  ORG.EDRPOU'
      'FROM'
      '  ORG'
      'WHERE'
      '  (ORG.DEPT <> ''0'' OR ORG.DEPT IS NULL)'
      'ORDER BY'
      '  EDRPOU'
      ''
    )
    Params = <>
    Macros = <>
    MacroCheck = True
    Left = 296
    Top = 200
  end
end
